<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Render Benchmark</title>
</head>
<body>
    <h1>Benchmark Results</h1>
    <pre id="results">Running...</pre>

    <!-- Hidden game container -->
    <div id="game-container" style="position: absolute; left: -9999px;">
        <p id="statusText"></p>
        <p id="turnText"></p>
        <p id="aiHandCount"></p>
        <p id="aiScore"></p>
        <p id="aiGo"></p>
        <p id="humanScore"></p>
        <p id="humanGo"></p>
        <div id="aiHand"></div>
        <div id="humanHand"></div>
        <div id="tableCards"></div>
        <div id="deckCount"></div>
        <div id="ppukPiles"></div>
        <div id="turnCountdown"></div>
        <div id="goStopModal">
            <div id="goStopTitle"></div>
            <div id="goStopScore"></div>
            <div id="goStopDetail"></div>
        </div>
        <div id="resultModal">
            <div id="resultConfetti"></div>
            <div id="resultTitle"></div>
            <div id="resultWinner"></div>
            <div id="resultFinalScore"></div>
        </div>
        <div id="aiLastPlay"></div>
        <div id="humanLastPlay"></div>
        <div id="aiCapturedCards"></div>
        <div id="humanCapturedCards"></div>
        <ul id="logList"></ul>
        <button id="goBtn"></button>
        <button id="stopBtn"></button>
        <button id="rulesBtn"></button>
        <button id="goDecisionBtn"></button>
        <button id="stopDecisionBtn"></button>
        <button id="newGameBtn"></button>
        <button id="voiceToggleBtn"></button>
    </div>

    <script src="game.js"></script>
    <script>
        // Wait for game.js to initialize
        setTimeout(() => {
            runBenchmark();
        }, 500);

        function runBenchmark() {
            const results = document.getElementById('results');
            const iterations = 1000;

            // Setup heavy state
            setupHeavyState();

            const start = performance.now();
            for (let i = 0; i < iterations; i++) {
                render();
            }
            const end = performance.now();
            const duration = end - start;

            results.textContent = `Rendered ${iterations} times in ${duration.toFixed(2)}ms\n` +
                                  `Average: ${(duration / iterations).toFixed(4)}ms per render`;

            console.log(`Benchmark finished: ${duration.toFixed(2)}ms`);
        }

        function setupHeavyState() {
            // Mock game state with lots of cards
            game.players = [
                { id: 'human', name: 'Human', hand: [], captured: [], score: 0, goCount: 3, shakeMultiplier: 2 },
                { id: 'ai', name: 'AI', hand: [], captured: [], score: 0, goCount: 2, shakeMultiplier: 1 }
            ];

            // Fill hands and captured with dummy cards
            for(let i=0; i<10; i++) {
                game.players[0].hand.push({ id: `h${i}`, month: i+1, type: 'junk', asset: '' });
                game.players[1].hand.push({ id: `a${i}`, month: i+1, type: 'junk', asset: '' });
            }

            for(let i=0; i<20; i++) {
                game.players[0].captured.push({ id: `hc${i}`, month: (i%12)+1, type: 'junk', asset: '' });
                game.players[1].captured.push({ id: `ac${i}`, month: (i%12)+1, type: 'junk', asset: '' });
            }

            game.table = [];
            for(let i=0; i<12; i++) {
                game.table.push({ id: `t${i}`, month: i+1, type: 'junk', asset: '' });
            }

            game.ppukPiles = [];
            game.ppukPiles.push({ month: 1, cards: [{ id: 'p1', month: 1, type: 'junk' }] });
            game.ppukPiles.push({ month: 2, cards: [{ id: 'p2', month: 2, type: 'junk' }] });

            game.turn = 0;
            game.gameOver = false;
        }
    </script>
</body>
</html>
